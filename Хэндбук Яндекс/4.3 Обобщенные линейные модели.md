#хэндбук #машинное_обучение 

[Хэндбук](https://education.yandex.ru/handbook/ml/article/obobshyonnye-linejnye-modeli)

# Обобщенные линейные модели

**GLM (generalized linead models)** - модели, где случайный шум зависит от $\mu(x)$, то есть математического ожидания выбранного распределения от $x$. К такому типу моделей относится *линейная и логистическая регрессии*.

**Линейная регрессия**:$$y|x \sim N(\langle w, x\rangle, \sigma^{2}) $$

**Логистическая регрессия**:$$y|x \sim Bern(\sigma(\langle w, x\rangle)) $$ $$\sigma(u)=\frac{1}{1 + e^{-u}}$$

**Функция связи** - связывает предсказание таких моделей $\mathbb{E}(y|x)$ с линейной функций $\langle x, w \rangle$ следующим образом:$$g(\mathbb{E}(y|x)) = \langle x, w \rangle$$
Можно сказать, что с помощью функции связи мы превращаем математическое ожидание от $x$ в линейную функцию.

**Для GLM нужно задать две составляющие:**
1) Параметризованное семейство распределений (часто из экспоненциальных);
2) Функцию связи.

И предсказание такой модели есть: $$\mathbb{E}(y|x)=g^{-1}(\langle x, w \rangle)\space (0)$$

# Принадлежность к экспоненциальному классу

Обычно, в контексте GLM, рассматривают подкласс экспоненциальных распределений вида: $$p(y|\theta, \psi) = \exp(\frac{y\theta - a(\theta)}{\psi}+b(y, \psi))=\frac{1}{\exp(\frac{a(\theta)}{\psi})}\exp(b(y, \psi))\exp\left(\frac{y\theta}{\psi}\right)\space(1)$$
$\theta$ и $\psi$ - скалярные параметры, вторая обычно еще и константная дисперсия.

**Само семейство экспоненциальных распределений характеризуется следующим:**$$p(y|\nu)=\frac{1}{h(\nu)}g(y)\cdot\exp(\nu^{T}u(y))\space(2)$$$$h(\nu)=\int g(x)\exp(\theta^{T}u(x))dx$$
*Если присмотреться, то формулы 1 и 2 схожи, если не идентичны. *

Далее из леммы: $$\frac{\delta\space log(h(\theta))}{\delta \space \theta}=\mathbb{E}(u(x))$$
**Она доказывается просто счётом интеграла, там все просто если внимательно приглядеться (не забывай про $dx$)**
следует следующее:  $$\mathbb{E}(y|x)=a`(\theta)$$ 
И, подставляя в 0, получаем однозначное определение функции $g$ и такая функция называется **каноническая функция связи**:$$a`(\langle x, w \rangle)=g^{-1}(\langle x, w \rangle):g = (a`(\langle x, w \rangle))^{-1}$$ 
